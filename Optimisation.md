
## Enable Caching
Make sure `CACHE=true` && `DB_SCHEMA_CACHE_DURATION` is set to an integer number like `60` in `proctected/.env`.

## Profiling
  > Enable profiling will make all none html page output fail, including json

SET `ENABLE_PROFILE_LOG=true` in `proctected/.env` to display profile.

To measure your code using profiling:
```php
// starting
if (Yii::app()->params['enableProfileLog']) {
	Yii::beginProfile('anyIdHere');
}

// your code to measure execution speed

// ending
if (Yii::app()->params['enableProfileLog']) {
	Yii::endProfile('anyIdHere');
}
```

## Pre generate Thumbnail
Thumbnail can either be pre-generated or live-generated. Use pre-generated by setting `THUMB_MODE="pre"` in `proctected/.env` where all thumbnails will automatically generated and store the moment images are uploaded.

## Why Slow
### Meta Structure and Item
Although convenience for developers, meta data itself is a join table relationships and will greatly decrease the system performance as the number of meta structure to a core model increased. More complex JOIN query and individual query to each of the `meta_item` table too.

Caching solve this problem. All meta are cache for a day, and these caches are remove when there's changes to the value by override model `afterSave()`.

### Relation
Model like `organization` load all related necessary objects in `afterFind` as below:

```php
protected function afterFind()
{
    if (empty($this->image_logo)) {
        $this->image_logo = $this->getDefaultImageLogo();
    }
    foreach ($this->impacts as $impact) {
        $this->inputImpacts[] = $impact->id;
    }
    foreach ($this->sdgs as $sdg) {
        $this->inputSdgs[] = $sdg->id;
    }
    foreach ($this->personas as $persona) {
        $this->inputPersonas[] = $persona->id;
    }
    foreach ($this->industries as $industry) {
        $this->inputIndustries[] = $industry->id;
    }
    foreach ($this->classifications as $classification) {
        $this->inputClassifications[] = $classification->id;
    }

    parent::afterFind();
}
```

In situation where list of organizations loaded, say 30, each has x5 relations (impacts, sgds, personas, industries, classifications) and that would be equal to 150 queries. 

## Troubleshoot
You may disable all custom modules to troubleshoot why slow. Make sure `MODULE_DISABLE_NONE_CORE=true` in `proctected/.env`.